gl---
title: "Project proposal"
author: "MEG"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(readr)
library(ggridges)
library(ggplot2)
library(usmap)
library(dplyr)
library(tigris)
library(stringr)
```

## 1. Introduction
 How does time, place, and gender affect the distribution of racial violence in the American South? This specific data set comes from The Burnham-Nobles Archive from The Civil Rights & Restorative Justice Project at Northeastern University School of Law. The Archive focuses on victims of anti-black violence. The project seeks to contextualize the history of anti-black violence in the United States. The Burnham-Nobles Archive has been working to collect reports for over 15 years and keep collecting. The victims_incidents data set specifically looks at 15 variables. It focuses its location on 11 different states in the American South. The variables include date, time, police presence, etc. 

## 2. Data

```{r analysis}
victims_incidents <- read_csv("../data/victims_incidents.csv")
glimpse(victims_incidents)

```

## 3. Data analysis plan

In a choropleth map with bar chart we are hoping to visualize these variables:

Density of incidents
Date (Year)
Gender
County

In a bar chart we are hoping to visualize these variables:
Perpetrator type
Conviction


We were considering researching laws in different areas, as they may be significant in swaying the outcome to 

The preliminary data analysis shows there are variations in the amount of victims based on gender throughout time. It also shows that there is variation in the number of incidents in each state throughout time. 
```{r graphs}
names(victims_incidents)
dim(victims_incidents)

ggplot(victims_incidents, aes(
  sex))+
  geom_bar()

victims_incidents<-victims_incidents|>
  drop_na(sex)
ggplot(victims_incidents, aes(
  incident_year_range_end, fill=sex))+
  geom_bar()

ggplot(victims_incidents, aes(
  incident_year_range_end, state, fill=state))+
  geom_density_ridges()
```
``` {r incidents_state_map}

incident_count <- victims_incidents %>%
  group_by(state) %>%
  summarize(incident_total = n())

plot_usmap(data = incident_count, values = "incident_total", include = .south_region, color = "black", exclude = c("OK", "KY", "WV", "MD", "DE", "DC"), labels = TRUE) + 
  scale_fill_continuous(low = "white", high = "red", name = "Incident Count") + 
  labs(title = "Incident Count By State")+
  theme(legend.position = "right")
```
```{r incidents_count_by_state}
victims_incidents %>%
  group_by(state) %>%
  summarise(total_incidents = n()) %>%
  arrange(desc(total_incidents)) %>% 
  print()

```
``` {r incidents_alabama_counties}

fips_data <- tigris::counties(state = "Alabama", class = "sf") %>%
  select(fips = GEOID, county = NAME)

alabama_incidents_fix <- victims_incidents %>%
  filter(state == "Alabama") %>%
  mutate(county = str_replace(county, " County", "")) %>%  # because county names don't match fips data
  group_by(county) %>%
  summarise(incident_count = n(), .groups = 'drop')

alabama_incidents <- alabama_incidents_fix %>%
  left_join(fips_data, by = "county")

# sorted_alabama <- alabama_incidents %>% 
#  arrange(desc(incident_count)) %>% 
# print(sorted_alabama) #for general viewing and to double check because things weren't joining right

plot_usmap(regions = "counties", data = alabama_incidents, values = "incident_count", include = "AL", color = "black") +
 scale_fill_continuous(low = "white", high = "red", name = "Incidents Count", na.value = "white") +
  labs(title = "Number of Incidents by County in Alabama",
       subtitle = "Of 203 total incidents in the state") +
  theme(legend.position = "right")

# add better coloring for more contrast and colorblindness
```

## 4. Data Ethics Review

The data ethics review section will be introduced in a separate class and is not part of the original proposal deadline.

